<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>React Login</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div id="root"></div>

    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>


    <!-- Source: https://ant.design/components/_util-cn-->
    <!-- Setting button (Ant Design Icons) -->
    <script src="https://unpkg.com/@ant-design/icons/dist/index.umd.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      // Use for AntDesignIcons
      const IconsGlobal = window.Icons || window.icons || window.AntDesignIcons;

      // Fake login API (demo)
      function fakeLoginApi({ email, password }) {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            if (email === "test@example.com" && password === "password123") {
              resolve({ token: "fake-jwt-token", user: { email } });
            } else {
              reject(new Error("Invalid email or password"));
            }
          }, 800);
        });
      }

      function LoginPage() {
        const [email, setEmail] = React.useState("");
        const [password, setPassword] = React.useState("");
        const [showPassword, setShowPassword] = React.useState(false);
        const [remember, setRemember] = React.useState(true);
        const [loading, setLoading] = React.useState(false);
        const [error, setError] = React.useState("");
        const [message, setMessage] = React.useState("");

        const validate = () => {
          if (!email) return "Please enter your email";
          const ok = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
          if (!ok) return "Invalid email format";
          if (!password) return "Please enter your password";
          if (password.length < 6) return "Password must be at least 6 characters";
          return "";
        };

        const handleSubmit = async (e) => {
          e.preventDefault();
          setError("");
          setMessage("");
          const v = validate();
          if (v) { setError(v); return; }

          try {
            setLoading(true);
            const res = await fakeLoginApi({ email, password });
            const storage = remember ? localStorage : sessionStorage;
            storage.setItem("auth_token", res.token);
            storage.setItem("auth_email", res.user.email);
            window.location.href = "home.html";
          } catch (err) {
            setError(err.message || "Login failed, please try again later");
          } finally {
            setLoading(false);
          }
        };

        return (
          <div className="page">
            {/* SettingOutlined */}
            <button
              type="button"
              className="settings-icon-btn"
              onClick={() => window.location.href = "setting.html"}
              aria-label="Settings"
              title="Settings"
            >
            {IconsGlobal
            ? <IconsGlobal.SettingOutlined style={{ fontSize: 28 }} />
            : "⚙️"}
            </button>

            <div className="card">
              <h1 className="title">Welcome</h1>

              {/* demo account information */}
              <p className="subtitle">
                Test account: <code>test@example.com / password123</code>
              </p>

              {error && <div className="alert alert-error">{error}</div>}
              {message && <div className="alert alert-success">{message}</div>}

              <form className="form" onSubmit={handleSubmit} noValidate>
                <div className="input-field">
                  <input
                    id="email"
                    type="email"
                    value={email}
                    onChange={(e) => setEmail(e.target.value)}
                    required
                    autoComplete="email"
                  />
                  <label htmlFor="email">Email:</label>
                </div>

                <div className="input-field">
                  <input
                    id="password"
                    type={showPassword ? "text" : "password"}
                    value={password}
                    onChange={(e) => setPassword(e.target.value)}
                    required
                    autoComplete="current-password"
                  />
                  <label htmlFor="password">Password:</label>

                  <button
                    type="button"
                    className="toggle-btn"
                    onClick={() => setShowPassword((s) => !s)}
                    aria-label={showPassword ? "Hide password" : "Show password"}
                  >
                    {showPassword ? "Hide" : "Show"}
                  </button>
                </div>

                <div className="row-between">
                  <label className="remember">
                    <input
                      type="checkbox"
                      checked={remember}
                      onChange={(e) => setRemember(e.target.checked)}
                    />
                    Remember me
                  </label>

                  <button
                    type="button"
                    className="link-btn"
                    onClick={() => alert("Please contact support to reset your password (demo)")}
                  >
                    Forgot password?
                  </button>
                </div>

                <button className="primary-btn" type="submit" disabled={loading}>
                  {loading ? "Logging in…" : "Login"}
                </button>
              </form>
            </div>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<LoginPage />);
    </script>
  </body>
</html>
